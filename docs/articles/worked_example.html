<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Worked Example • deident</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Worked Example">
<meta property="og:description" content="deident">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">deident</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/blur_example.html">Blur Example</a>
    </li>
    <li>
      <a href="../articles/encrypt_example.html">Encrypt Example</a>
    </li>
    <li>
      <a href="../articles/rationale.html">Rationale for De-identification</a>
    </li>
    <li>
      <a href="../articles/reusing_methods.html">Re-using Methods</a>
    </li>
    <li>
      <a href="../articles/shuffle_example.html">Shuffle Example</a>
    </li>
    <li>
      <a href="../articles/transformations.html">transformations</a>
    </li>
    <li>
      <a href="../articles/worked_example.html">Worked Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Worked Example</h1>
            
      
      
      <div class="hidden name"><code>worked_example.Rmd</code></div>

    </div>

    
    
<p>To assist new users, this vignette serves as a worked example of
building, applying and saving a de-identification pipeline. Due to the
risk of suppling data with genuine PID to be redacted, we instead supply
a synthetic data set comprising of artificial PID,
<code>ShiftsWorked</code>.</p>
<p>The data set consists of 3,100 observations where each row lists the
work done (shift status, actual work done, and daily pay) by an
individual on a given day. <code>ShiftsWorked</code> consists of 7
variables:</p>
<ul>
<li>Record ID: integer, primary key.</li>
<li>Employee: character, 100 artificial staff names</li>
<li>Date: date.</li>
<li>Shift: character, one of ‘Day’, ‘Night’, ‘Rest’</li>
<li>Shift Start: character, start time of shift (missing for ‘Rest’
shift).</li>
<li>Shift End: character, end time of shift (missing for ‘Rest’
shift).</li>
<li>Daily Pay: numeric, calculated remuneration (£).</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">deident</span><span class="op">)</span></span>
<span><span class="va">ShiftsWorked</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="20%">
<col width="14%">
<col width="8%">
<col width="16%">
<col width="13%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="right">Record ID</th>
<th align="left">Employee</th>
<th align="left">Date</th>
<th align="left">Shift</th>
<th align="left">Shift Start</th>
<th align="left">Shift End</th>
<th align="right">Daily Pay</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Maria Cook</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="right">78.06</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Stephen Cox</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="right">155.36</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Kimberly Ortiz</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="right">77.81</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Nathan Alvarez</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">15:01</td>
<td align="right">202.98</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Samuel Parker</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">16:01</td>
<td align="left">23:01</td>
<td align="right">210.52</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">Scott Morris</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="right">141.78</td>
</tr>
</tbody>
</table>
<p>Consider a hypothetical problem. As part of a research project we
wish to share this data set with others, but we don’t have permission to
share individuals names. How do we solve this issue?</p>
<p>The simplest method for de-identification is a direct replacement,
e.g. ‘pseudonymization’. Using <code>deident</code> comes in two
steps:</p>
<ol style="list-style-type: decimal">
<li>Define a pipeline</li>
<li>Apply to the data set</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pipeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deident.html">deident</a></span><span class="op">(</span><span class="va">ShiftsWorked</span>, <span class="st">"psudonymize"</span>, <span class="va">Employee</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/apply_deident.html">apply_deident</a></span><span class="op">(</span><span class="va">ShiftsWorked</span>, <span class="va">pipeline</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="13%">
<col width="16%">
<col width="8%">
<col width="17%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">Record ID</th>
<th align="left">Employee</th>
<th align="left">Date</th>
<th align="left">Shift</th>
<th align="left">Shift Start</th>
<th align="left">Shift End</th>
<th align="right">Daily Pay</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">bJF1Q</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="right">78.06</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">SAqSi</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="right">155.36</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">CAxmx</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="right">77.81</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">eryDe</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">15:01</td>
<td align="right">202.98</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">jXGii</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">16:01</td>
<td align="left">23:01</td>
<td align="right">210.52</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">P3Snf</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="right">141.78</td>
</tr>
</tbody>
</table>
<p>This approach is relatively simple, but what if we wish to dig into
the transformation? In the case of this direct replacement, we might
want to access the lookup table that underpins the pseudonymizer. The
easiest way to achieve this is to create an instance of a
<code>Pseudonymizer</code> class, and pass it in to deident:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psu</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Pseudonymizer.html">Pseudonymizer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pipeline2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/deident.html">deident</a></span><span class="op">(</span><span class="va">ShiftsWorked</span>, <span class="va">psu</span>, <span class="va">Employee</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/apply_deident.html">apply_deident</a></span><span class="op">(</span><span class="va">ShiftsWorked</span>, <span class="va">pipeline2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="13%">
<col width="16%">
<col width="8%">
<col width="17%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">Record ID</th>
<th align="left">Employee</th>
<th align="left">Date</th>
<th align="left">Shift</th>
<th align="left">Shift Start</th>
<th align="left">Shift End</th>
<th align="right">Daily Pay</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">jZuaY</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="right">78.06</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">DQWe8</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="right">155.36</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">y70br</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="right">77.81</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">KPCZr</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">15:01</td>
<td align="right">202.98</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">6Ihl3</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">16:01</td>
<td align="left">23:01</td>
<td align="right">210.52</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">bZGNo</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="right">141.78</td>
</tr>
</tbody>
</table>
<p>and once the transform has been performed we can check the
<code>lookup</code> attribute:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">psu</span><span class="op">$</span><span class="va">lookup</span><span class="op">)</span></span>
<span><span class="co">#&gt;            Maria Cook           Stephen Cox        Kimberly Ortiz </span></span>
<span><span class="co">#&gt;               "jZuaY"               "DQWe8"               "y70br" </span></span>
<span><span class="co">#&gt;        Nathan Alvarez         Samuel Parker          Scott Morris </span></span>
<span><span class="co">#&gt;               "KPCZr"               "6Ihl3"               "bZGNo" </span></span>
<span><span class="va">...</span></span></code></pre></div>
<p>Often we will need to apply multiple transformations. Considering the
<code>StaffsWorked</code> data, imagine the employees are complaining
they don’t want their exact salaries divulged (even once names are
removed). We can expand the pipeline to allow for this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">blur</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/NumericBlurer.html">NumericBlurer</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">multistep_pipeline</span> <span class="op">&lt;-</span> <span class="va">ShiftsWorked</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/deident.html">deident</a></span><span class="op">(</span><span class="va">psu</span>, <span class="va">Employee</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/deident.html">deident</a></span><span class="op">(</span><span class="va">blur</span>, <span class="va">`Daily Pay`</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ShiftsWorked</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/apply_deident.html">apply_deident</a></span><span class="op">(</span><span class="va">multistep_pipeline</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="13%">
<col width="16%">
<col width="8%">
<col width="17%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">Record ID</th>
<th align="left">Employee</th>
<th align="left">Date</th>
<th align="left">Shift</th>
<th align="left">Shift Start</th>
<th align="left">Shift End</th>
<th align="left">Daily Pay</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">jZuaY</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="left">(0,100]</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">DQWe8</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="left">(100,200]</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">y70br</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="left">(0,100]</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">KPCZr</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">15:01</td>
<td align="left">(200,300]</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">6Ihl3</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">16:01</td>
<td align="left">23:01</td>
<td align="left">(200,300]</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">bZGNo</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="left">(100,200]</td>
</tr>
</tbody>
</table>
<p>As well as having multiple data transforms to choose from,
<code>deident</code> also allows the user to easily serialize their
pipelines to a .yml file for audit and transfer. This is done via the
calls <code>to_yaml</code> and <code>from_yaml</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multistep_pipeline</span><span class="op">$</span><span class="fu">to_yaml</span><span class="op">(</span><span class="st">"multistep_pipeline.yml"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">restored_pipeline</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/from_yaml.html">from_yaml</a></span><span class="op">(</span><span class="st">"multistep_pipeline.yml"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ShiftsWorked</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/apply_deident.html">apply_deident</a></span><span class="op">(</span><span class="va">restored_pipeline</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="14%">
<col width="13%">
<col width="16%">
<col width="8%">
<col width="17%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th align="right">Record ID</th>
<th align="left">Employee</th>
<th align="left">Date</th>
<th align="left">Shift</th>
<th align="left">Shift Start</th>
<th align="left">Shift End</th>
<th align="left">Daily Pay</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">jZuaY</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="left">(0,100]</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">DQWe8</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="left">(100,200]</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">y70br</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">16:01</td>
<td align="left">(0,100]</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">KPCZr</td>
<td align="left">2015-01-01</td>
<td align="left">Day</td>
<td align="left">08:01</td>
<td align="left">15:01</td>
<td align="left">(200,300]</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">6Ihl3</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">16:01</td>
<td align="left">23:01</td>
<td align="left">(200,300]</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">bZGNo</td>
<td align="left">2015-01-01</td>
<td align="left">Night</td>
<td align="left">17:01</td>
<td align="left">00:01</td>
<td align="left">(100,200]</td>
</tr>
</tbody>
</table>
</div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robert Cook, Md Assaduzaman, Sarahjane Jones.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
